<!doctype html>
<html>
  <head>
      <meta charset=utf-8>
      <title>The case for multiple named insets</title>
      <style>@layer reset, default, layout;</style>
      <link rel=stylesheet href=/assets/css/reset.css>
      <link rel=stylesheet href=/assets/css/fonts.css>
      <link rel=stylesheet href=/assets/css/default.css>
      <link rel=stylesheet href=/assets/css/layout.css>
      <link rel=stylesheet href=/assets/css/style.css>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel=canonical href="https://odland.dev/2024/08/24/the-case-for-multiple-insets.html">
      <meta http-equiv="refresh" content="0; url=https://odland.dev/2024/08/24/the-case-for-multiple-insets.html" />
      <link rel="me" href="https://front-end.social/@johannes">
  </head>
  <body>
  
   <header>
      <a href="/" class="site-title">Johannes Odland</a>
      <nav></nav>
    </header>

    <article role="main">
      <header>
        <time datetime="Sat Aug 24 2024 13:00:00 GMT+0000 (Coordinated Universal Time)" pubdate>
          Aug 24, 2024
        </time>
        <h1>The case for multiple named insets</h1>
      </header>
      <div class="content"><p>When sticky positioning became supported in most<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> major browsers in 2017, it felt revolutionary.
The times of wrapper elements and swapping positioning schemes were soon a thing of the past.
We were on the track to providing a jitter free user experience.</p>
<p>While revolutionary, it felt fairly limited.
These limitations were well documented in <a href="https://github.com/w3c/csswg-drafts/issues/2496">issue #2496</a> by jonjohnjohnson.</p>
<h2>Constrained by its block level ancestor</h2>
<p>One of the issues is that it is cumbersome to define the sticky constraint rectangle.</p>
<p>The sticky element will only be pushed as far as it stays within its containing block.
But for sticky positioning the containing block is the nearest block level ancestor<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>.</p>
<p><strong>The sticky element cannot be wrapped by any block level element without being contained by it.</strong></p>
<p>Sometimes we need the sticky element to escape its block level ancestor and rather use a box further up the ancestor chain as a constraint.
Fortunately the CSSWG is discussing something like a <a href="https://github.com/w3c/csswg-drafts/issues/9868"><code>position-container</code> property</a> that will allow us to change the containing block.</p>
<p>Hopefully, this issue will soon be resolved.</p>
<h2>Defining insets from the containing block</h2>
<p>The other issue is that it is cumbersome to define insets from the containing block.</p>
<p>In absolute positioning, you can simply use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/inset">box inset properties</a> to define insets from the containing block.</p>
<p>But for sticky positioning, the box inset properties are already used as insets from the scrollport.
Currently, they can't define insets from the containing block as well.</p>
<p>To define insets from the containing block we have to use the margins of the element.
But, the margin properties are <em>also</em> used to define the in-flow margin.</p>
<p>Due to this dual interpretation, and that it is unclear how collapsing margins would apply,
<a href="https://github.com/w3c/csswg-drafts/issues/9052#issuecomment-1642600755">the CSSWG has resolved</a> to not consider the margins when calculating the sticky position.</p>
<p><strong>This leaves us in a bind.</strong></p>
<p>Using margins is problematic, but currently it's the only way we can affect the insets from the containing block for sticky-pos elements.</p>
<p><strong>We need to define insets for multiple boxes, but can currently only affect <em>one</em> using the box inset properties.</strong></p>
<h2>A proposal</h2>
<p>Issue <a href="https://github.com/w3c/csswg-drafts/issues/2496">#2496</a> suggested adding a separate <code>sticky</code> property.
But, it could be confusing if containing block insets  sometimes are defined in the box inset properties,
and other times in a separate property.</p>
<p>What if we could define multiple named box insets?</p>
<p>To define insets for a sticky positioned element that sticks to the scrollport and is inset 20px from the containing block, we could write this:</p>
<pre class="language-css"><code class="language-css"><span class="token property">inset-block</span><span class="token punctuation">:</span>
  scrollport 0<span class="token punctuation">,</span>
  containing-block 20px<span class="token punctuation">;</span></code></pre>
<p>If the element was only to be sticky to the top, we could do this:</p>
<pre class="language-css"><code class="language-css"><span class="token property">top</span><span class="token punctuation">:</span> scrollport 0<span class="token punctuation">;</span>
<span class="token property">bottom</span><span class="token punctuation">:</span> containing-block 20px<span class="token punctuation">;</span></code></pre>
<p>Since scrollport would be the default inset name under sticky positioning, the name could be dropped in the <code>top</code> property.
This would ensure backwards compatibility.</p>
<pre class="language-css"><code class="language-css"><span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token property">bottom</span><span class="token punctuation">:</span> containing-block 20px<span class="token punctuation">;</span></code></pre>
<p>Inset names that have no effect under the positioning scheme would simply be ignored.</p>
<h2>TL;DR</h2>
<p>Sticky positioning is still fairly limited.<br>
It's cumbersome to set insets from the containing block under sticky positioning, but it's <em>possible</em> using margins.
Since the CSSWG has resolved to ignore margins, we need another way of defining these insets.</p>
<p>I have <a href="https://github.com/w3c/csswg-drafts/issues/10754">proposed to support multiple named insets</a> in the box inset properties.</p>
<p>Hopefully we can find a solution in the not-so-distant future.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Excluding IE that unfortunately stuck around for way to long. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>This is simplified. Check out <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block">Identifying the containing block</a> for a more precise definition. <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div>
    </article>
  
    <footer>
      <h2>Johannes Odland</h2>
      <p>Infrequent posts about CSS and other frontend stuff.</p>
      <ul>
        <li><a href="https://front-end.social/@johannes">Mastodon</a></li>
        <li><a href="https://github.com/johannesodland">Github</a></li>
        <li><a href="/feed.xml">Atom feed</a></li>
      </ul>
      <p>Built with <a href="https://www.11ty.dev">Eleventy</a>.</p>
    </footer>
  </body>
</html>